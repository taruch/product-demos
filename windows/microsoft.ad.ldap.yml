---
plugin: microsoft.ad.ldap
auth_protocol: negotiate
encrypt: true
attributes:
  comment: this
  objectSid:
    computer_sid: null
  OperatingSystem:
    operating_system: null
  operatingSystemVersion: null
  DistinguishedName:
    microsoft_ad_distinguished_name: this
  pwdLastSet:
    password_last_set_datetime: this | microsoft.ad.as_datetime
  location: null
  memberOf:
    computer_membership: this | microsoft.ad.parse_dn | map(attribute="0.1")
groups:
  windows: true
  production: '"Production" in computer_membership'
keyed_groups:
  - key: operating_system | lower
    prefix: os
    default_value: unknown
  - key: location | lower
    default_value: unknown
    prefix: location
